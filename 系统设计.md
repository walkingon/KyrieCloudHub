# KyrieCloudHub系统设计文档

## 应用概述

KyrieCloudHub是一款使用Flutter技术开发的，跨平台（Windows、Android等）支持多种云服务厂商（腾讯云、阿里云等）对象存储服务的聚合网盘服务客户端，该应用旨在为用户提供一种拥有独立控制权限的私有云盘服务。

## 核心功能

*说明：因各家云服务厂商对同一种服务的产品命名不同，如腾讯云中的对象存储COS与阿里云中的OSS，我们后文均以腾讯云产品及概念为例。*

### 1.账号登录

登录平台账号获取安全凭证是一切云盘文件操作的前提，当前应用提供以访问密钥（SecretID + SecretKey）的方式进行平台登录。密钥需要用户在官方开发平台自行创建获取。

应用目前需要支持登录的平台有：腾讯云、阿里云

### 2.查看存储桶列表

存储桶是文件存储的容器和载体，用户登录平台账号后，自动查询并列出存储桶列表。（暂不提供存储桶的创建和删除功能，用户在平台自行创建管理存储桶）

### 3.存储桶内文件管理

- 查看存储桶内文件列表

- 文件的下载

- 文件的删除

- 文件的上传

## 用户界面交互流程设计

### 设计要点

1. 应用中任何一个云厂商平台都可满足核心功能实现，用户一旦习惯使用某一个厂商平台后，不会轻易切换，因此平台登录的切换入口是一个非常低频的操作，可以设计在较深层次的界面中。

2. 重要操作需要二次确认对话框，如文件的删除。

### 交互流程

#### 1.App启动后进入主界面

主界面左侧为抽屉栏，子菜单依次为“平台切换”、“设置”、“关于”。顶部AppBar水平居中显示为当前使用的平台名称，如“腾讯云”、“阿里云”或空内容（未选择平台时）

- 当用户为新用户，即应用本地没有查询到用户上一次登录的平台记录时，顶部AppBar显示空标题，界面中心显示一个“去选择平台”按钮，点击后进入平台选择界面。

- 当应用本地有用户上一次登录记录时，顶部AppBar显示平台名称，主界面列出查询到的存储桶列表。

*说明：登录概念只是方便用户理解。因该应用的功能是基于云厂商平台提供的无状态的HTTP请求API，并不存在实际的登录协议，应用内部对登录动作的处理实际上只做登录信息的本地存储*

#### 2.左侧抽屉栏的功能

用户点击左侧抽屉栏，展开子菜单“平台切换”、“设置”、“关于”。

- 选择“平台切换”，进入平台选择界面

    - 平台选择界面列出可供选择的平台选项：“腾讯云”、“阿里云”。选项需显示登录状态（即是否有上一次登录成功的记录）。如对于有上一次登录成功记录的选项，选项中显示一个绿色对号的状态图标。对于有绿色对号状态的选项，选项后额外提供一个“登出”的按钮，点击该登出按钮后清理登录记录并刷新选项显示状态。
    - 当用户点击选择的平台选项为未登录状态（即用户从未使用该平台选项登录成功过），则弹出登录对话框。

        - 登录对话框显示需要输入的登录信息有：SecretID、SecretKey。用户输入全部信息后可点击“登录”按钮进行登录，或关闭该对话框以取消登录。
        - 用户点击登录且登录成功后，返回主界面刷新界面显示AppBar标题、存储桶列表。

    - 当用户点击选择的平台选项有上一次登录成功记录，则直接使用上一次登录记录进行登录，并返回主界面刷新相关内容显示。

- 选择“设置”，进入设置界面


- 选择“关于”，进入关于界面


## 技术架构设计